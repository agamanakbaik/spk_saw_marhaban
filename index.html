<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SPK SAW - Admin Panel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        /* Efek sidebar */
        #sidebar-wrapper {
            transition: margin-left 0.3s ease-in-out;
            width: 15rem;
            min-height: 100vh;
        }
        
        #wrapper.toggled #sidebar-wrapper {
            margin-left: -15rem;
        }
        
        @media (min-width: 768px) {
            #sidebar-wrapper {
                margin-left: 0;
            }
            #wrapper.toggled #sidebar-wrapper {
                margin-left: -15rem;
            }
        }
        
        /* CSS untuk tombol download yang sedang loading (spinner) */
        button:disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }
        
        .spinner {
            display: inline-block;
            width: 1.25rem;
            height: 1.25rem;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* CSS untuk scrollbar di chat window */
        #chat-messages {
            scroll-behavior: smooth;
        }
        #chat-messages::-webkit-scrollbar {
            width: 0;
            background: transparent;
        }
        
        /* CSS untuk menyembunyikan elemen saat mencetak */
        @media print {
            #sidebar-wrapper,
            header,
            #run-saw-btn,
            .cetak-sembunyi,
            #chat-bubble,
            #chat-window {
                display: none !important;
            }
            #page-content-wrapper {
                width: 100% !important;
                margin-left: 0 !important;
            }
            main {
                padding: 0 !important;
            }
            .bg-white {
                box-shadow: none !important;
                border: 1px solid #ccc;
            }
        }
    </style>
</head>

<body class="bg-gray-100 dark:bg-gray-900 font-sans">
    <div class="flex" id="wrapper">
        <div class="bg-white dark:bg-gray-800 border-r border-gray-200 dark:border-gray-700 md:relative fixed z-30" id="sidebar-wrapper">
            <div class="sidebar-heading text-gray-900 dark:text-white p-4 text-xl font-bold border-b border-gray-200 dark:border-gray-700">
                SPK SAW
            </div>
            <nav class="flex flex-col p-2">
                <p class="text-gray-400 dark:text-gray-500 px-2 pt-4 pb-1 text-xs font-semibold uppercase">
                    SUPER ADMIN
                </p>
                <a href="#" id="menu-manajemen-admin" class="p-3 text-gray-700 dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition duration-150 flex items-center" onclick="loadContent('manajemen-admin')">
                    <i class="bi bi-person-gear mr-2 text-gray-400"></i>
                    Manajemen Admin
                </a>
                <a href="#" id="menu-backup-db" class="p-3 text-gray-700 dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition duration-150 flex items-center" onclick="loadContent('backup-db')">
                    <i class="bi bi-database-down mr-2 text-gray-400"></i>
                    Backup Database
                </a>
                <p class="text-gray-400 dark:text-gray-500 px-2 pt-4 pb-1 text-xs font-semibold uppercase">
                    ADMIN PANEL
                </p>
                <a href="#" class="p-3 text-gray-700 dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition duration-150 flex items-center" onclick="loadContent('dashboard')">
                    <i class="bi bi-grid-1x2-fill mr-2 text-gray-400"></i>
                    Dashboard
                </a>
                <a href="#" class="p-3 text-gray-700 dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition duration-150 flex items-center" onclick="loadContent('alternatif')">
                    <i class="bi bi-people-fill mr-2 text-gray-400"></i>
                    Data Alternatif
                </a>
                <a href="#" class="p-3 text-gray-700 dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition duration-150 flex items-center" onclick="loadContent('kriteria')">
                    <i class="bi bi-list-task mr-2 text-gray-400"></i>
                    Data Kriteria
                </a>
                <div>
                    <button id="saw-menu-toggle" class="w-full flex items-center justify-between p-3 text-gray-700 dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition duration-150">
                  <span class="flex items-center">
                    <i class="bi bi-bar-chart-line-fill mr-2 text-gray-400"></i>
                    Seleksi Metode SAW
                  </span>
                  <i
                    id="saw-menu-arrow"
                    class="bi bi-chevron-down transition-transform duration-200"
                  ></i>
                </button>
                    <div id="saw-menu-content" class="hidden flex flex-col pl-5">
                        <a href="#" class="p-3 text-gray-700 dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition duration-150 flex items-center" onclick="loadContent('penilaian')">
                            <i class="bi bi-check-square-fill mr-2 text-gray-400"></i> Nilai Alternatif
                        </a>
                        <a href="#" class="p-3 text-gray-700 dark:text-white hover:bg-gray-100 dark:hover:bg-gray-700 rounded-md transition duration-150 flex items-center" onclick="loadContent('perhitungan')">
                            <i class="bi bi-calculator-fill mr-2 text-gray-400"></i> Hasil Perhitungan
                        </a>
                    </div>
                </div>
            </nav>
        </div>

        <div id="page-content-wrapper" class="flex-grow min-h-screen">
            <header class="bg-white dark:bg-gray-800 shadow-md p-4 flex justify-between items-center cetak-sembunyi">
                <button class="text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 font-bold py-2 px-4 rounded md:hidden" id="sidebarToggle">
                    <i class="bi bi-list"></i>
                </button>
                
                <div class="w-full"></div> <div class="ml-auto flex items-center space-x-4">
                    <button id="theme-toggle" class="text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-lg p-2 focus:outline-none">
                        <i id="theme-toggle-dark-icon" class="bi bi-moon-fill hidden h-5 w-5"></i>
                        <i id="theme-toggle-light-icon" class="bi bi-sun-fill hidden h-5 w-5"></i>
                    </button>

                    <div class="relative">
                        <button id="userMenuButton" class="flex items-center space-x-2 text-gray-700 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 px-3 py-2 rounded-lg focus:outline-none">
                            <span id="userNameDisplay" class="font-medium">Admin</span>
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                            </svg>
                        </button>
                        <div id="userMenuDropdown" class="absolute right-0 mt-2 w-48 bg-white dark:bg-gray-700 rounded-md shadow-xl z-20 hidden">
                            <a href="#" id="logoutBtn" class="block px-4 py-2 text-sm text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-gray-600">
                                <i class="bi bi-box-arrow-right mr-2"></i>Logout
                            </a>
                        </div>
                    </div>
                </div>
            </header>

            <main class="p-6">
                <div id="content-container">
                    <h1 class="text-3xl font-bold text-gray-800 dark:text-white mb-4">
                        Selamat Datang!
                    </h1>
                    <p class="text-gray-600 dark:text-gray-300">Silakan pilih menu di sidebar.</p>
                </div>
            </main>
        </div>
    </div>

    <div id="modal-container" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center z-50 hidden p-4">
        </div>

    <div id="toast-container" class="fixed top-5 right-5 z-[100] space-y-3">
      </div>

    <button id="chat-bubble" class="cetak-sembunyi fixed bottom-6 right-6 bg-blue-600 text-white w-16 h-16 rounded-full shadow-lg flex items-center justify-center z-40 transition-transform hover:scale-110">
        <i class="bi bi-chat-dots-fill text-3xl"></i>
    </button>

    <div id="chat-window" class="cetak-sembunyi fixed bottom-24 right-6 w-80 h-96 bg-white dark:bg-gray-800 rounded-lg shadow-2xl z-50 flex flex-col hidden transition-all">
        <div class="flex justify-between items-center p-3 bg-blue-600 text-white rounded-t-lg">
            <h3 class="font-bold">Asisten SPK</h3>
            <button id="chat-close" class="text-white hover:text-gray-200">
                <i class="bi bi-x-lg"></i>
            </button>
        </div>

        <div id="chat-messages" class="flex-1 p-4 overflow-y-auto space-y-3 bg-white dark:bg-gray-800">
            <div class="chat-message-bot flex">
                <div class="bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 p-3 rounded-lg max-w-xs">
                    <p>Halo! Saya Asisten AI. Tanyakan sesuatu tentang SAW, kriteria, atau alternatif.</p>
                </div>
            </div>
        </div>

        <form id="chat-form" class="p-3 border-t border-gray-200 dark:border-gray-700">
            <div class="flex space-x-2">
                <input type="text" id="chat-input" placeholder="Ketik pesan Anda..." class="flex-1 border border-gray-300 dark:border-gray-600 rounded-full px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white dark:bg-gray-700 text-gray-900 dark:text-white">
                <button type="submit" class="bg-blue-600 text-white rounded-full w-10 h-10 flex items-center justify-center">
                    <i class="bi bi-send-fill"></i>
                </button>
            </div>
        </form>
    </div>
    <script>
        // === Toggle Sidebar ===
        document.getElementById("sidebarToggle").addEventListener("click", () => {
            document.getElementById("wrapper").classList.toggle("toggled");
        });

        // === Toggle Dropdown User ===
        document
            .getElementById("userMenuButton")
            .addEventListener("click", () => {
                const dropdown = document.getElementById("userMenuDropdown");
                dropdown.classList.toggle("hidden");
            });

        // === Toggle Dropdown SAW Menu ===
        document
            .getElementById("saw-menu-toggle")
            .addEventListener("click", () => {
                const content = document.getElementById("saw-menu-content");
                const arrow = document.getElementById("saw-menu-arrow");
                content.classList.toggle("hidden");
                arrow.classList.toggle("rotate-180");
            });

        // Klik di luar dropdown untuk menutup
        window.addEventListener("click", function(e) {
            const userMenuButton = document.getElementById("userMenuButton");
            if (userMenuButton && !userMenuButton.contains(e.target) && !document.getElementById("userMenuDropdown").contains(e.target)) {
                document.getElementById("userMenuDropdown").classList.add("hidden");
            }
        });
    </script>
    
    <script>
        const darkIcon = document.getElementById('theme-toggle-dark-icon');
        const lightIcon = document.getElementById('theme-toggle-light-icon');
        
        // Cek tema saat halaman dimuat
        if (localStorage.getItem('color-theme') === 'dark' || (!('color-theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
            lightIcon.classList.remove('hidden');
        } else {
            document.documentElement.classList.remove('dark');
            darkIcon.classList.remove('hidden');
        }

        const toggleButton = document.getElementById('theme-toggle');
        toggleButton.addEventListener('click', () => {
            darkIcon.classList.toggle('hidden');
            lightIcon.classList.toggle('hidden');
            
            if (localStorage.getItem('color-theme')) {
                if (localStorage.getItem('color-theme') === 'light') {
                    document.documentElement.classList.add('dark');
                    localStorage.setItem('color-theme', 'dark');
                } else {
                    document.documentElement.classList.remove('dark');
                    localStorage.setItem('color-theme', 'light');
                }
            } else {
                if (document.documentElement.classList.contains('dark')) {
                    document.documentElement.classList.remove('dark');
                    localStorage.setItem('color-theme', 'light');
                } else {
                    document.documentElement.classList.add('dark');
                    localStorage.setItem('color-theme', 'dark');
                }
            }
        });
    </script>

    <script src="app.js"></script>
</body>
</html>